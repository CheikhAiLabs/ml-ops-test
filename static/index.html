<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ChurnGuard ‚Äî Churn Prediction</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <!-- Animated background -->
  <div class="bg-gradient"></div>
  <div class="bg-grid"></div>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-brand">
      <span class="brand-icon">üõ°Ô∏è</span>
      <span class="brand-text">ChurnGuard</span>
    </div>
    <div class="nav-links">
      <a href="#predict" class="nav-link active" data-section="predict">Predict</a>
      <a href="#model" class="nav-link" data-section="model">Model</a>
      <a href="#about" class="nav-link" data-section="about">About</a>
    </div>
    <div class="nav-status" id="api-status">
      <span class="status-dot"></span>
      <span class="status-text">Connecting‚Ä¶</span>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="container">

    <!-- PREDICT SECTION -->
    <section id="predict" class="section active">
      <div class="section-header">
        <h1>Customer Churn Prediction</h1>
        <p class="subtitle">Enter customer details to estimate churn risk with explainable AI</p>
      </div>

      <div class="predict-grid">
        <!-- Form Card -->
        <div class="card glass-card form-card">
          <div class="card-header">
            <h2>üìã Customer Profile</h2>
          </div>
          <form id="predict-form" autocomplete="off">

            <!-- Section: Customer -->
            <div class="form-section">
              <h3 class="form-section-title">üë§ Customer</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="gender">Gender</label>
                  <div class="select-wrapper">
                    <select id="gender" name="gender">
                      <option value="0" selected>Male</option>
                      <option value="1">Female</option>
                    </select>
                    <span class="select-arrow">‚ñº</span>
                  </div>
                </div>
                <div class="form-group">
                  <label for="age">Age</label>
                  <div class="input-wrapper">
                    <input type="number" id="age" name="age" min="18" max="80" value="35" required />
                    <span class="input-hint">18‚Äì80</span>
                  </div>
                  <input type="range" class="range-slider" id="age-range" min="18" max="80" value="35" />
                </div>
                <div class="form-group toggle-group">
                  <label>Partner</label>
                  <label class="toggle">
                    <input type="checkbox" id="partner" />
                    <span class="toggle-slider"></span>
                    <span class="toggle-label" id="partner-label">No</span>
                  </label>
                </div>
                <div class="form-group toggle-group">
                  <label>Dependents</label>
                  <label class="toggle">
                    <input type="checkbox" id="dependents" />
                    <span class="toggle-slider"></span>
                    <span class="toggle-label" id="dependents-label">No</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Section: Services -->
            <div class="form-section">
              <h3 class="form-section-title">üì± Services</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="internet_service">Internet</label>
                  <div class="select-wrapper">
                    <select id="internet_service" name="internet_service">
                      <option value="0">None</option>
                      <option value="1">DSL</option>
                      <option value="2" selected>Fiber Optic</option>
                    </select>
                    <span class="select-arrow">‚ñº</span>
                  </div>
                </div>
                <div class="form-group">
                  <label for="contract_type">Contract</label>
                  <div class="select-wrapper">
                    <select id="contract_type" name="contract_type">
                      <option value="0">Monthly</option>
                      <option value="1" selected>Annual</option>
                      <option value="2">Biennial</option>
                    </select>
                    <span class="select-arrow">‚ñº</span>
                  </div>
                </div>
                <div class="form-group toggle-group">
                  <label>Online Security</label>
                  <label class="toggle">
                    <input type="checkbox" id="online_security" />
                    <span class="toggle-slider"></span>
                    <span class="toggle-label" id="online_security-label">No</span>
                  </label>
                </div>
                <div class="form-group toggle-group">
                  <label>Tech Support</label>
                  <label class="toggle">
                    <input type="checkbox" id="tech_support" />
                    <span class="toggle-slider"></span>
                    <span class="toggle-label" id="tech_support-label">No</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Section: Billing -->
            <div class="form-section">
              <h3 class="form-section-title">üí∞ Billing</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="tenure_months">Tenure (months)</label>
                  <div class="input-wrapper">
                    <input type="number" id="tenure_months" name="tenure_months" min="0" max="72" value="24" required />
                    <span class="input-hint">0‚Äì72 mo</span>
                  </div>
                  <input type="range" class="range-slider" id="tenure_months-range" min="0" max="72" value="24" />
                </div>
                <div class="form-group">
                  <label for="monthly_charges">Monthly Charges ($)</label>
                  <div class="input-wrapper">
                    <input type="number" id="monthly_charges" name="monthly_charges" min="18" max="120" step="0.01" value="65" required />
                    <span class="input-hint">$18‚Äì$120</span>
                  </div>
                  <input type="range" class="range-slider" id="monthly_charges-range" min="18" max="120" value="65" />
                </div>
                <div class="form-group">
                  <label for="payment_method">Payment</label>
                  <div class="select-wrapper">
                    <select id="payment_method" name="payment_method">
                      <option value="0">Bank Transfer</option>
                      <option value="1" selected>Credit Card</option>
                      <option value="2">Electronic Check</option>
                      <option value="3">Mailed Check</option>
                    </select>
                    <span class="select-arrow">‚ñº</span>
                  </div>
                </div>
                <div class="form-group toggle-group">
                  <label>Paperless Billing</label>
                  <label class="toggle">
                    <input type="checkbox" id="paperless_billing" checked />
                    <span class="toggle-slider"></span>
                    <span class="toggle-label" id="paperless_billing-label">Yes</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Section: Support -->
            <div class="form-section">
              <h3 class="form-section-title">üé´ Support</h3>
              <div class="form-grid form-grid-single">
                <div class="form-group">
                  <label for="num_tickets">Support Tickets</label>
                  <div class="input-wrapper">
                    <input type="number" id="num_tickets" name="num_tickets" min="0" max="10" value="1" required />
                    <span class="input-hint">0‚Äì10</span>
                  </div>
                  <input type="range" class="range-slider" id="num_tickets-range" min="0" max="10" value="1" />
                </div>
              </div>
            </div>

            <button type="submit" class="btn btn-primary" id="predict-btn">
              <span class="btn-icon">‚ö°</span>
              <span class="btn-text">Predict</span>
              <span class="btn-loader" hidden></span>
            </button>
          </form>
        </div>

        <!-- Result Card -->
        <div class="card glass-card result-card" id="result-card">
          <div class="card-header">
            <h2>üìä Result</h2>
          </div>

          <!-- Placeholder -->
          <div class="result-placeholder" id="result-placeholder">
            <div class="placeholder-icon">üîÆ</div>
            <p>Fill in the form and click <strong>Predict</strong></p>
          </div>

          <!-- Result content (hidden by default) -->
          <div class="result-content" id="result-content" hidden>
            <!-- Risk gauge -->
            <div class="gauge-container">
              <svg class="gauge" viewBox="0 0 200 120">
                <path class="gauge-bg" d="M 20 100 A 80 80 0 0 1 180 100" />
                <path class="gauge-fill" id="gauge-fill" d="M 20 100 A 80 80 0 0 1 180 100" />
              </svg>
              <div class="gauge-value" id="gauge-value">0%</div>
              <div class="gauge-label" id="gauge-label">Churn probability</div>
            </div>

            <!-- Verdict -->
            <div class="verdict" id="verdict">
              <span class="verdict-icon" id="verdict-icon"></span>
              <span class="verdict-text" id="verdict-text"></span>
            </div>

            <!-- Details -->
            <div class="result-details" id="result-details">
              <div class="detail-row">
                <span class="detail-label">Prediction</span>
                <span class="detail-value" id="detail-prediction"></span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Probability</span>
                <span class="detail-value" id="detail-proba"></span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Risk Level</span>
                <span class="detail-value" id="detail-risk"></span>
              </div>
            </div>

            <!-- Feature Contributions (Explainability) -->
            <div class="contributions" id="contributions" hidden>
              <h3 class="contributions-title">üîç Key Drivers</h3>
              <p class="contributions-subtitle">What drives this prediction</p>
              <div class="contributions-list" id="contributions-list"></div>
            </div>

            <!-- Recommendation -->
            <div class="recommendation" id="recommendation"></div>
          </div>
        </div>
      </div>

      <!-- Quick presets -->
      <div class="card glass-card presets-card">
        <h3>‚ö° Quick Presets</h3>
        <div class="presets-grid">
          <button class="preset-btn" data-preset='{"gender":1,"age":25,"partner":0,"dependents":0,"tenure_months":3,"monthly_charges":95,"contract_type":0,"payment_method":2,"paperless_billing":1,"internet_service":2,"online_security":0,"tech_support":0,"num_tickets":5}'>
            <span class="preset-emoji">üö®</span>
            <span class="preset-name">High Risk</span>
            <span class="preset-desc">New, monthly, fiber, no support, e-check</span>
          </button>
          <button class="preset-btn" data-preset='{"gender":0,"age":45,"partner":1,"dependents":1,"tenure_months":48,"monthly_charges":50,"contract_type":2,"payment_method":0,"paperless_billing":0,"internet_service":1,"online_security":1,"tech_support":1,"num_tickets":0}'>
            <span class="preset-emoji">‚úÖ</span>
            <span class="preset-name">Low Risk</span>
            <span class="preset-desc">Loyal, biennial, DSL, full add-ons</span>
          </button>
          <button class="preset-btn" data-preset='{"gender":0,"age":35,"partner":1,"dependents":0,"tenure_months":14,"monthly_charges":75,"contract_type":1,"payment_method":1,"paperless_billing":1,"internet_service":2,"online_security":0,"tech_support":1,"num_tickets":2}'>
            <span class="preset-emoji">‚öñÔ∏è</span>
            <span class="preset-name">Medium Risk</span>
            <span class="preset-desc">Annual contract, fiber, partial add-ons</span>
          </button>
          <button class="preset-btn" data-preset='{"gender":1,"age":62,"partner":1,"dependents":1,"tenure_months":60,"monthly_charges":42,"contract_type":2,"payment_method":1,"paperless_billing":0,"internet_service":1,"online_security":1,"tech_support":1,"num_tickets":1}'>
            <span class="preset-emoji">üèÜ</span>
            <span class="preset-name">Loyal Customer</span>
            <span class="preset-desc">Long tenure, DSL, all add-ons, low charges</span>
          </button>
        </div>
      </div>
    </section>

    <!-- MODEL SECTION -->
    <section id="model" class="section">
      <div class="section-header">
        <h1>Model Information</h1>
        <p class="subtitle">Technical details of the production prediction model</p>
      </div>

      <div class="model-grid">
        <div class="card glass-card" id="model-info-card">
          <div class="card-header"><h2>ü§ñ Model</h2></div>
          <div id="model-info-content" class="model-info-content">
            <p class="loading-text">Loading model info...</p>
          </div>
        </div>

        <div class="card glass-card" id="model-metrics-card">
          <div class="card-header"><h2>üìà Metrics</h2></div>
          <div id="model-metrics-content" class="model-metrics-content">
            <p class="loading-text">Loading metrics...</p>
          </div>
        </div>

        <div class="card glass-card" id="model-features-card">
          <div class="card-header"><h2>üß¨ Features (16)</h2></div>
          <div id="model-features-content" class="model-features-content">
            <p class="loading-text">Loading...</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT SECTION -->
    <section id="about" class="section">
      <div class="section-header">
        <h1>About</h1>
        <p class="subtitle">Architecture and technical stack of the MLOps project</p>
      </div>

      <div class="about-grid">
        <div class="card glass-card">
          <div class="card-header"><h2>üèóÔ∏è Architecture</h2></div>
          <div class="about-content">
            <p>ChurnGuard is a production-grade MLOps churn prediction system built with industry best practices:</p>
            <ul class="tech-list">
              <li><strong>Model:</strong> GradientBoostingClassifier with GridSearchCV (5-fold CV, 16 features)</li>
              <li><strong>Explainability:</strong> Per-prediction feature contributions via leave-one-out attribution</li>
              <li><strong>API:</strong> FastAPI + Uvicorn (async, high-performance)</li>
              <li><strong>Tracking:</strong> MLflow for experiment versioning + real-time inference tracing</li>
              <li><strong>Validation:</strong> Pandera for data quality checks (13 raw + 3 engineered features)</li>
              <li><strong>Monitoring:</strong> Prometheus + Grafana (22-panel real-time dashboard)</li>
              <li><strong>Drift:</strong> Evidently for data drift detection</li>
              <li><strong>Pipeline:</strong> DVC for reproducibility</li>
              <li><strong>CI/CD:</strong> GitHub Actions + Docker multi-stage + Trivy security scan</li>
              <li><strong>Quality:</strong> Ruff, mypy, pre-commit, 20 pytest tests</li>
            </ul>
          </div>
        </div>
        <div class="card glass-card">
          <div class="card-header"><h2>üì° Endpoints API</h2></div>
          <div class="about-content">
            <div class="endpoint-list">
              <div class="endpoint">
                <span class="method get">GET</span>
                <code>/health</code>
                <span class="endpoint-desc">API & model health status</span>
              </div>
              <div class="endpoint">
                <span class="method post">POST</span>
                <code>/predict</code>
                <span class="endpoint-desc">Churn prediction + feature contributions</span>
              </div>
              <div class="endpoint">
                <span class="method get">GET</span>
                <code>/model-info</code>
                <span class="endpoint-desc">Model metadata & feature means</span>
              </div>
              <div class="endpoint">
                <span class="method get">GET</span>
                <code>/metrics</code>
                <span class="endpoint-desc">Prometheus metrics (15+)</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>ChurnGuard MLOps ‚Äî Built with ‚ù§Ô∏è by <strong>CheikhAiLabs</strong></p>
  </footer>

  <script src="/static/app.js"></script>
</body>
</html>
